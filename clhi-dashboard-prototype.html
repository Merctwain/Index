<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Loss and Hope Index | Philadelphia Dashboard</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap');
        
        :root {
            --bg-dark: #1a1a2e;
            --bg-card: #16213e;
            --bg-card-light: #1f2b4d;
            --text-primary: #f5f5f0;
            --text-secondary: #a8a8b0;
            --accent-gold: #d4a853;
            --accent-coral: #e07850;
            --accent-teal: #6ab0b0;
            --accent-red: #e05050;
            --accent-green: #50c878;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Source Sans Pro', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        .header {
            padding: 2.5rem 3rem;
            text-align: center;
            border-bottom: 1px solid rgba(212, 168, 83, 0.3);
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
        }
        
        .org-label {
            font-size: 0.7rem;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: var(--accent-gold);
            margin-bottom: 0.75rem;
            font-weight: 600;
        }
        
        h1 {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.4rem;
        }
        
        .tagline {
            font-size: 1.1rem;
            color: var(--accent-coral);
            font-style: italic;
            margin-bottom: 0.75rem;
        }
        
        .subtitle {
            font-size: 0.95rem;
            color: var(--text-secondary);
            max-width: 650px;
            margin: 0 auto;
        }
        
        .section {
            padding: 2.5rem 3rem;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .section-header { margin-bottom: 1.25rem; }
        
        .section-number {
            font-size: 0.65rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--accent-gold);
            margin-bottom: 0.4rem;
        }
        
        h2 {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.6rem;
            color: var(--text-primary);
            margin-bottom: 0.4rem;
        }
        
        .section-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .cta-box {
            background: var(--bg-card-light);
            border-left: 4px solid var(--accent-gold);
            padding: 1rem 1.25rem;
            margin-top: 1.25rem;
            border-radius: 0 8px 8px 0;
        }
        
        .cta-box h4 {
            color: var(--accent-gold);
            font-size: 0.8rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: 0.4rem;
        }
        
        .cta-box p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .cta-box .highlight {
            color: var(--accent-coral);
            font-weight: 600;
        }
        
        .bar-chart-container {
            background: var(--bg-card);
            border-radius: 10px;
            padding: 1rem 1.25rem;
            max-height: 380px;
            overflow-y: auto;
        }
        
        .bar-row {
            display: flex;
            align-items: center;
            margin-bottom: 0.4rem;
            cursor: pointer;
            padding: 0.3rem 0.4rem;
            border-radius: 4px;
            transition: background 0.2s;
        }
        
        .bar-row:hover { background: rgba(255,255,255,0.05); }
        
        .bar-label {
            width: 130px;
            font-size: 0.8rem;
            color: var(--text-primary);
            flex-shrink: 0;
        }
        
        .bar-label .zip {
            font-size: 0.65rem;
            color: var(--text-secondary);
        }
        
        .bar-wrapper {
            flex: 1;
            height: 22px;
            background: rgba(255,255,255,0.05);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }
        
        .bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease-out;
            position: relative;
        }
        
        .bar-value {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.7rem;
            font-weight: 600;
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        
        .bar-value-outside {
            margin-left: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--accent-coral);
            min-width: 45px;
        }
        
        .bar-high { background: linear-gradient(90deg, #e05050, #e07850); }
        .bar-medium-high { background: linear-gradient(90deg, #e07850, #d4a853); }
        .bar-medium { background: linear-gradient(90deg, #d4a853, #a4b878); }
        .bar-low { background: linear-gradient(90deg, #a4b878, #6ab0b0); }
        
        .indicator-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-bottom: 1rem;
        }
        
        .indicator-btn {
            padding: 0.35rem 0.75rem;
            background: var(--bg-card);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .indicator-btn:hover {
            border-color: var(--accent-gold);
            color: var(--text-primary);
        }
        
        .indicator-btn.active {
            background: var(--accent-gold);
            color: var(--bg-dark);
            border-color: var(--accent-gold);
            font-weight: 600;
        }
        
        .heartbeat-container {
            background: #0a0a12;
            border-radius: 12px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .heartbeat-container::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: 
                repeating-linear-gradient(0deg, transparent, transparent 50px, rgba(106, 176, 176, 0.04) 50px, rgba(106, 176, 176, 0.04) 51px),
                repeating-linear-gradient(90deg, transparent, transparent 50px, rgba(106, 176, 176, 0.04) 50px, rgba(106, 176, 176, 0.04) 51px);
            pointer-events: none;
        }
        
        .heartbeat-stats {
            display: flex;
            justify-content: center;
            gap: 4rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }
        
        .heartbeat-stat { text-align: center; }
        
        .heartbeat-stat-value {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 2.8rem;
            font-weight: 700;
            color: var(--accent-coral);
        }
        
        .heartbeat-stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .heartbeat-svg {
            width: 100%;
            height: 350px;
            position: relative;
            z-index: 1;
        }
        
        .heartbeat-line {
            fill: none;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        
        .line-black {
            stroke: #e07850;
            filter: drop-shadow(0 0 8px rgba(224, 120, 80, 0.6));
        }
        
        .line-white {
            stroke: #6ab0b0;
            filter: drop-shadow(0 0 8px rgba(106, 176, 176, 0.6));
        }
        
        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 2.5rem;
            margin-top: 1.5rem;
            position: relative;
            z-index: 1;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .legend-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
        }
        
        .data-point {
            cursor: pointer;
            transition: all 0.2s;
            opacity: 0;
        }
        
        .data-point:hover, .data-point.active { opacity: 1; }
        .heartbeat-svg:hover .data-point { opacity: 0.6; }
        .heartbeat-svg:hover .data-point:hover { opacity: 1; }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        @media (max-width: 900px) {
            .two-column { grid-template-columns: 1fr; }
        }
        
        .grouped-bar-container {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            height: 100%;
        }
        
        .grouped-bar-title {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .grouped-bar-subtitle {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        .grouped-bar-svg {
            width: 100%;
            height: 320px;
        }
        
        .grouped-legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .grouped-legend-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }
        
        .grouped-legend-box {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        
        .grouped-bar {
            cursor: pointer;
            transition: opacity 0.2s, filter 0.2s;
        }
        
        .grouped-bar:hover { filter: brightness(1.2); }
        
        .then-now-container {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            height: 100%;
        }
        
        .then-now-title {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .then-now-subtitle {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        .then-now-rows {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .then-now-row {
            display: grid;
            grid-template-columns: 100px 1fr 60px 1fr 70px;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: rgba(255,255,255,0.02);
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .then-now-row:hover { background: rgba(255,255,255,0.05); }
        
        .then-now-zip {
            font-size: 0.8rem;
            color: var(--text-primary);
            font-weight: 600;
        }
        
        .then-now-bar {
            height: 18px;
            border-radius: 3px;
            position: relative;
        }
        
        .then-now-bar.then { background: var(--accent-teal); }
        .then-now-bar.now { background: var(--accent-coral); }
        
        .then-now-bar span {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.65rem;
            font-weight: 600;
            color: white;
        }
        
        .then-now-arrow {
            text-align: center;
            color: var(--accent-gold);
            font-size: 1rem;
        }
        
        .then-now-change {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--accent-coral);
            text-align: right;
        }
        
        .then-now-legend {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        .then-now-legend span {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .then-now-legend .dot {
            width: 10px;
            height: 10px;
            border-radius: 2px;
        }
        
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 0.75rem;
        }
        
        .stat-card {
            background: var(--bg-card);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            border-top: 3px solid var(--accent-coral);
        }
        
        .stat-value {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--accent-coral);
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.2rem;
            line-height: 1.3;
        }
        
        .rankings-container { margin-top: 1.5rem; }
        
        .rankings-title {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        .ranking-row {
            display: flex;
            align-items: center;
            background: var(--bg-card);
            border-radius: 6px;
            padding: 0.6rem 0.75rem;
            margin-bottom: 0.4rem;
            border-left: 4px solid;
        }
        
        .ranking-row:nth-child(1) { border-color: #e05050; }
        .ranking-row:nth-child(2) { border-color: #e07850; }
        .ranking-row:nth-child(3) { border-color: #d4a853; }
        .ranking-row:nth-child(4) { border-color: #a4b878; }
        .ranking-row:nth-child(5) { border-color: #6ab0b0; }
        
        .ranking-number {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--accent-coral);
            width: 30px;
        }
        
        .ranking-info {
            flex: 1;
            margin-left: 0.5rem;
        }
        
        .ranking-neighborhood {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.85rem;
        }
        
        .ranking-zip {
            font-size: 0.7rem;
            color: var(--text-secondary);
        }
        
        .ranking-score { text-align: right; }
        
        .ranking-score-value {
            font-weight: 700;
            color: var(--accent-coral);
            font-size: 0.95rem;
        }
        
        .ranking-score-label {
            font-size: 0.6rem;
            color: var(--text-secondary);
        }
        
        .footer {
            padding: 1.5rem 3rem;
            text-align: center;
            background: var(--bg-card);
        }
        
        .footer-org {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 0.4rem;
        }
        
        .footer-org a {
            color: var(--accent-gold);
            text-decoration: none;
        }
        
        .footer-sources {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
            line-height: 1.4;
        }
        
        .tooltip {
            position: fixed;
            background: var(--bg-card);
            border: 1px solid var(--accent-gold);
            border-radius: 8px;
            padding: 10px 14px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 1000;
            max-width: 220px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }
        
        .tooltip.visible { opacity: 1; }
        .tooltip-title { font-weight: 600; color: var(--text-primary); margin-bottom: 3px; }
        .tooltip-value { color: var(--accent-coral); font-weight: 600; }
        .tooltip-secondary { color: var(--accent-teal); }
        
        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .section { padding: 1.5rem; }
            .header { padding: 1.5rem; }
            .bar-label { width: 100px; font-size: 0.75rem; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="org-label">Wealth + Work Futures Lab | Drexel University Lindy Institute</div>
        <h1>Community Loss & Hope Index</h1>
        <p class="tagline">"Grief as Sacred Data: Loss and Hope as Design"</p>
        <p class="subtitle">Mapping community grief across Philadelphia — because loss isn't random, it's place-based and persistent.</p>
    </header>
    
    <section class="section">
        <div class="section-header">
            <div class="section-number">Section 01</div>
            <h2>Where Loss Lives</h2>
            <p class="section-subtitle">Loss indicators by ZIP code — select an indicator to explore</p>
        </div>
        
        <div class="indicator-selector">
            <button class="indicator-btn active" data-indicator="loss">Loss Index</button>
            <button class="indicator-btn" data-indicator="overdose">Overdose</button>
            <button class="indicator-btn" data-indicator="homicide">Homicide</button>
            <button class="indicator-btn" data-indicator="incarceration">Incarceration</button>
            <button class="indicator-btn" data-indicator="foster">Foster Care</button>
            <button class="indicator-btn" data-indicator="shooting">Shootings</button>
        </div>
        
        <div class="bar-chart-container" id="barChart"></div>
        
        <div class="cta-box">
            <h4>What This Means</h4>
            <p>The same neighborhoods appear at the top of <span class="highlight">every loss indicator</span>. This geographic concentration means targeted interventions can reach the communities that need them most.</p>
        </div>
    </section>
    
    <section class="section">
        <div class="section-header">
            <div class="section-number">Section 02</div>
            <h2>The Bereavement Gap</h2>
            <p class="section-subtitle">42 Years of Childhood Loss by Race (1980-2022)</p>
        </div>
        
        <div class="heartbeat-stats">
            <div class="heartbeat-stat">
                <div class="heartbeat-stat-value">1.5x – 2x</div>
                <div class="heartbeat-stat-label">Higher bereavement rate for Black children</div>
            </div>
            <div class="heartbeat-stat">
                <div class="heartbeat-stat-value">42</div>
                <div class="heartbeat-stat-label">Years of persistent disparity</div>
            </div>
        </div>
        
        <div class="heartbeat-container">
            <svg class="heartbeat-svg" viewBox="0 0 900 350" preserveAspectRatio="xMidYMid meet">
                <g stroke="rgba(106, 176, 176, 0.1)" stroke-width="1">
                    <line x1="60" y1="50" x2="860" y2="50"/>
                    <line x1="60" y1="110" x2="860" y2="110"/>
                    <line x1="60" y1="170" x2="860" y2="170"/>
                    <line x1="60" y1="230" x2="860" y2="230"/>
                    <line x1="60" y1="290" x2="860" y2="290"/>
                </g>
                
                <text x="50" y="55" fill="#6ab0b0" font-size="11" text-anchor="end">1.4%</text>
                <text x="50" y="115" fill="#6ab0b0" font-size="11" text-anchor="end">1.2%</text>
                <text x="50" y="175" fill="#6ab0b0" font-size="11" text-anchor="end">1.0%</text>
                <text x="50" y="235" fill="#6ab0b0" font-size="11" text-anchor="end">0.8%</text>
                <text x="50" y="295" fill="#6ab0b0" font-size="11" text-anchor="end">0.6%</text>
                
                <text x="60" y="320" fill="#6ab0b0" font-size="11" text-anchor="middle">1980</text>
                <text x="220" y="320" fill="#6ab0b0" font-size="11" text-anchor="middle">1990</text>
                <text x="380" y="320" fill="#6ab0b0" font-size="11" text-anchor="middle">2000</text>
                <text x="540" y="320" fill="#6ab0b0" font-size="11" text-anchor="middle">2010</text>
                <text x="700" y="320" fill="#6ab0b0" font-size="11" text-anchor="middle">2020</text>
                
                <path class="heartbeat-line line-white" d="M60,240 L76,244 L92,238 L108,242 L124,236 L140,240 L156,234 L172,238 L188,232 L204,236 L220,240 L236,234 L252,238 L268,232 L284,236 L300,230 L316,234 L332,238 L348,232 L364,236 L380,230 L396,234 L412,238 L428,232 L444,236 L460,230 L476,234 L492,230 L508,234 L524,228 L540,232 L556,236 L572,230 L588,234 L604,228 L620,232 L636,236 L652,230 L668,234 L684,238 L700,232 L716,236 L732,242 L748,248 L764,254 L780,248 L796,252 L812,246 L828,240 L844,244 L860,242"/>
                
                <path class="heartbeat-line line-black" d="M60,140 L76,130 L92,145 L108,125 L124,140 L140,115 L156,135 L172,105 L188,90 L204,75 L220,95 L236,105 L252,120 L268,110 L284,130 L300,118 L316,138 L332,125 L348,145 L364,132 L380,152 L396,140 L412,158 L428,145 L444,162 L460,150 L476,168 L492,158 L508,172 L524,160 L540,178 L556,165 L572,182 L588,170 L604,186 L620,172 L636,188 L652,175 L668,192 L684,180 L700,195 L716,205 L732,215 L748,225 L764,218 L780,208 L796,218 L812,205 L828,195 L844,205 L860,198"/>
                
                <line x1="204" y1="75" x2="240" y2="45" stroke="#d4a853" stroke-width="1"/>
                <text x="245" y="40" fill="#d4a853" font-size="11">Peak: 1989</text>
                <text x="245" y="54" fill="#d4a853" font-size="11">(1.93x disparity)</text>
                
                <line x1="764" y1="218" x2="800" y2="185" stroke="#d4a853" stroke-width="1"/>
                <text x="805" y="180" fill="#d4a853" font-size="11">COVID-19</text>
                <text x="805" y="194" fill="#d4a853" font-size="11">impact (2020)</text>
            </svg>
            
            <div class="chart-legend">
                <div class="legend-item">
                    <div class="legend-dot" style="background: #e07850; box-shadow: 0 0 10px rgba(224, 120, 80, 0.7);"></div>
                    <span>Black or African American</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #6ab0b0; box-shadow: 0 0 10px rgba(106, 176, 176, 0.7);"></div>
                    <span>White</span>
                </div>
            </div>
        </div>
        
        <div class="cta-box">
            <h4>What This Means</h4>
            <p>For <span class="highlight">42 consecutive years</span>, Black children have been 1.5 to 2 times more likely to lose a parent or sibling. This isn't a recent crisis — it's a <span class="highlight">structural pattern</span>.</p>
        </div>
    </section>
    
    <section class="section">
        <div class="section-header">
            <div class="section-number">Section 03</div>
            <h2>The Compounding Effect</h2>
            <p class="section-subtitle">Multiple loss indicators concentrated in the same neighborhoods</p>
        </div>
        
        <div class="two-column">
            <div class="grouped-bar-container">
                <div class="grouped-bar-title">All Indicators by Neighborhood</div>
                <div class="grouped-bar-subtitle">Rates per 1,000 residents (2023)</div>
                
                <svg class="grouped-bar-svg" viewBox="0 0 400 320" preserveAspectRatio="xMidYMid meet">
                    <line x1="70" y1="30" x2="70" y2="250" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>
                    <line x1="70" y1="250" x2="380" y2="250" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>
                    
                    <text x="60" y="35" fill="#a8a8b0" font-size="9" text-anchor="end">12</text>
                    <text x="60" y="90" fill="#a8a8b0" font-size="9" text-anchor="end">9</text>
                    <text x="60" y="145" fill="#a8a8b0" font-size="9" text-anchor="end">6</text>
                    <text x="60" y="200" fill="#a8a8b0" font-size="9" text-anchor="end">3</text>
                    <text x="60" y="254" fill="#a8a8b0" font-size="9" text-anchor="end">0</text>
                    
                    <g transform="translate(85, 0)">
                        <rect x="0" y="75" width="10" height="175" fill="#e05050" rx="2"/>
                        <rect x="12" y="95" width="10" height="155" fill="#e07850" rx="2"/>
                        <rect x="24" y="155" width="10" height="95" fill="#d4a853" rx="2"/>
                        <rect x="36" y="125" width="10" height="125" fill="#6ab0b0" rx="2"/>
                        <rect x="48" y="145" width="10" height="105" fill="#50c878" rx="2"/>
                        <text x="29" y="268" fill="#f5f5f0" font-size="9" text-anchor="middle" font-weight="600">Kensington</text>
                        <text x="29" y="280" fill="#a8a8b0" font-size="7" text-anchor="middle">19134</text>
                    </g>
                    
                    <g transform="translate(160, 0)">
                        <rect x="0" y="35" width="10" height="215" fill="#e05050" rx="2"/>
                        <rect x="12" y="115" width="10" height="135" fill="#e07850" rx="2"/>
                        <rect x="24" y="135" width="10" height="115" fill="#d4a853" rx="2"/>
                        <rect x="36" y="135" width="10" height="115" fill="#6ab0b0" rx="2"/>
                        <rect x="48" y="160" width="10" height="90" fill="#50c878" rx="2"/>
                        <text x="29" y="268" fill="#f5f5f0" font-size="9" text-anchor="middle" font-weight="600">Strawberry M.</text>
                        <text x="29" y="280" fill="#a8a8b0" font-size="7" text-anchor="middle">19132</text>
                    </g>
                    
                    <g transform="translate(235, 0)">
                        <rect x="0" y="55" width="10" height="195" fill="#e05050" rx="2"/>
                        <rect x="12" y="100" width="10" height="150" fill="#e07850" rx="2"/>
                        <rect x="24" y="145" width="10" height="105" fill="#d4a853" rx="2"/>
                        <rect x="36" y="120" width="10" height="130" fill="#6ab0b0" rx="2"/>
                        <rect x="48" y="150" width="10" height="100" fill="#50c878" rx="2"/>
                        <text x="29" y="268" fill="#f5f5f0" font-size="9" text-anchor="middle" font-weight="600">Nicetown</text>
                        <text x="29" y="280" fill="#a8a8b0" font-size="7" text-anchor="middle">19140</text>
                    </g>
                    
                    <g transform="translate(310, 0)">
                        <rect x="0" y="75" width="10" height="175" fill="#e05050" rx="2"/>
                        <rect x="12" y="120" width="10" height="130" fill="#e07850" rx="2"/>
                        <rect x="24" y="160" width="10" height="90" fill="#d4a853" rx="2"/>
                        <rect x="36" y="140" width="10" height="110" fill="#6ab0b0" rx="2"/>
                        <rect x="48" y="165" width="10" height="85" fill="#50c878" rx="2"/>
                        <text x="29" y="268" fill="#f5f5f0" font-size="9" text-anchor="middle" font-weight="600">SW Philly</text>
                        <text x="29" y="280" fill="#a8a8b0" font-size="7" text-anchor="middle">19143</text>
                    </g>
                </svg>
                
                <div class="grouped-legend">
                    <div class="grouped-legend-item"><div class="grouped-legend-box" style="background: #e05050;"></div><span>Incarceration</span></div>
                    <div class="grouped-legend-item"><div class="grouped-legend-box" style="background: #e07850;"></div><span>Overdose</span></div>
                    <div class="grouped-legend-item"><div class="grouped-legend-box" style="background: #d4a853;"></div><span>Homicide</span></div>
                    <div class="grouped-legend-item"><div class="grouped-legend-box" style="background: #6ab0b0;"></div><span>Foster Care</span></div>
                    <div class="grouped-legend-item"><div class="grouped-legend-box" style="background: #50c878;"></div><span>Early Death</span></div>
                </div>
            </div>
            
            <div class="then-now-container">
                <div class="then-now-title">Overdose Deaths: Then vs. Now</div>
                <div class="then-now-subtitle">Change by ZIP code (2012 → 2023)</div>
                
                <div class="then-now-rows">
                    <div class="then-now-row">
                        <div class="then-now-zip">Kensington<br><span style="font-size:0.65rem;color:#a8a8b0;">19134</span></div>
                        <div class="then-now-bar then" style="width: 45%;"><span>2.1</span></div>
                        <div class="then-now-arrow">→</div>
                        <div class="then-now-bar now" style="width: 100%;"><span>5.59</span></div>
                        <div class="then-now-change">+166%</div>
                    </div>
                    <div class="then-now-row">
                        <div class="then-now-zip">Nicetown<br><span style="font-size:0.65rem;color:#a8a8b0;">19140</span></div>
                        <div class="then-now-bar then" style="width: 40%;"><span>1.8</span></div>
                        <div class="then-now-arrow">→</div>
                        <div class="then-now-bar now" style="width: 86%;"><span>4.82</span></div>
                        <div class="then-now-change">+168%</div>
                    </div>
                    <div class="then-now-row">
                        <div class="then-now-zip">Strawberry M.<br><span style="font-size:0.65rem;color:#a8a8b0;">19132</span></div>
                        <div class="then-now-bar then" style="width: 35%;"><span>1.5</span></div>
                        <div class="then-now-arrow">→</div>
                        <div class="then-now-bar now" style="width: 74%;"><span>4.15</span></div>
                        <div class="then-now-change">+177%</div>
                    </div>
                    <div class="then-now-row">
                        <div class="then-now-zip">Frankford<br><span style="font-size:0.65rem;color:#a8a8b0;">19124</span></div>
                        <div class="then-now-bar then" style="width: 30%;"><span>1.3</span></div>
                        <div class="then-now-arrow">→</div>
                        <div class="then-now-bar now" style="width: 68%;"><span>3.78</span></div>
                        <div class="then-now-change">+191%</div>
                    </div>
                    <div class="then-now-row">
                        <div class="then-now-zip">SW Philly<br><span style="font-size:0.65rem;color:#a8a8b0;">19143</span></div>
                        <div class="then-now-bar then" style="width: 28%;"><span>1.2</span></div>
                        <div class="then-now-arrow">→</div>
                        <div class="then-now-bar now" style="width: 62%;"><span>3.45</span></div>
                        <div class="then-now-change">+188%</div>
                    </div>
                    <div class="then-now-row">
                        <div class="then-now-zip">Chestnut Hill<br><span style="font-size:0.65rem;color:#a8a8b0;">19118</span></div>
                        <div class="then-now-bar then" style="width: 8%;"><span>0.2</span></div>
                        <div class="then-now-arrow">→</div>
                        <div class="then-now-bar now" style="width: 8%;"><span>0.42</span></div>
                        <div class="then-now-change">+110%</div>
                    </div>
                </div>
                
                <div class="then-now-legend">
                    <span><div class="dot" style="background: var(--accent-teal);"></div> 2012</span>
                    <span><div class="dot" style="background: var(--accent-coral);"></div> 2023</span>
                </div>
            </div>
        </div>
        
        <div class="cta-box">
            <h4>What This Means</h4>
            <p>In high-loss neighborhoods, <span class="highlight">every indicator is elevated</span>. This is the <span class="highlight">compounding effect</span> — loss begets loss.</p>
        </div>
    </section>
    
    <section class="section">
        <div class="section-header">
            <div class="section-number">Section 04</div>
            <h2>2023 At A Glance</h2>
            <p class="section-subtitle">Key statistics and highest-loss communities</p>
        </div>
        
        <div class="stats-bar">
            <div class="stat-card"><div class="stat-value">19134</div><div class="stat-label">Highest Loss ZIP</div></div>
            <div class="stat-card"><div class="stat-value">1,224</div><div class="stat-label">Overdose Deaths</div></div>
            <div class="stat-card"><div class="stat-value">7,019</div><div class="stat-label">In State Prison</div></div>
            <div class="stat-card"><div class="stat-value">1,998</div><div class="stat-label">Foster Care Entries</div></div>
            <div class="stat-card"><div class="stat-value">69x</div><div class="stat-label">Incarceration Gap</div></div>
        </div>
        
        <div class="rankings-container">
            <div class="rankings-title">Top 5 Highest Loss ZIP Codes</div>
            <div class="ranking-row"><div class="ranking-number">1</div><div class="ranking-info"><div class="ranking-neighborhood">Kensington</div><div class="ranking-zip">ZIP 19134</div></div><div class="ranking-score"><div class="ranking-score-value">0.72</div><div class="ranking-score-label">Loss Index</div></div></div>
            <div class="ranking-row"><div class="ranking-number">2</div><div class="ranking-info"><div class="ranking-neighborhood">Nicetown-Tioga</div><div class="ranking-zip">ZIP 19140</div></div><div class="ranking-score"><div class="ranking-score-value">0.62</div><div class="ranking-score-label">Loss Index</div></div></div>
            <div class="ranking-row"><div class="ranking-number">3</div><div class="ranking-info"><div class="ranking-neighborhood">Strawberry Mansion</div><div class="ranking-zip">ZIP 19132</div></div><div class="ranking-score"><div class="ranking-score-value">0.58</div><div class="ranking-score-label">Loss Index</div></div></div>
            <div class="ranking-row"><div class="ranking-number">4</div><div class="ranking-info"><div class="ranking-neighborhood">Frankford</div><div class="ranking-zip">ZIP 19124</div></div><div class="ranking-score"><div class="ranking-score-value">0.55</div><div class="ranking-score-label">Loss Index</div></div></div>
            <div class="ranking-row"><div class="ranking-number">5</div><div class="ranking-info"><div class="ranking-neighborhood">Southwest Philadelphia</div><div class="ranking-zip">ZIP 19143</div></div><div class="ranking-score"><div class="ranking-score-value">0.51</div><div class="ranking-score-label">Loss Index</div></div></div>
        </div>
    </section>
    
    <footer class="footer">
        <p class="footer-org">A project of the <a href="https://wealthworkfutures.org" target="_blank">Wealth + Work Futures Lab</a> at Drexel University's Lindy Institute</p>
        <p class="footer-sources">Data Sources: PA Vital Registration, Philadelphia DHS, Philadelphia Police, PHC4, Prison Policy Initiative, Judi's House CBEM</p>
    </footer>
    
    <div class="tooltip" id="tooltip"></div>
    
    <script>
        const tooltip = document.getElementById('tooltip');
        
        const zipData = {
            loss: [
                { name: 'Kensington', zip: '19134', value: 0.72 },
                { name: 'Nicetown-Tioga', zip: '19140', value: 0.62 },
                { name: 'Strawberry Mansion', zip: '19132', value: 0.58 },
                { name: 'Frankford', zip: '19124', value: 0.55 },
                { name: 'Southwest Philly', zip: '19143', value: 0.51 },
                { name: 'Cobbs Creek', zip: '19139', value: 0.46 },
                { name: 'North Philadelphia', zip: '19121', value: 0.44 },
                { name: 'Olney', zip: '19120', value: 0.42 },
                { name: 'Germantown', zip: '19144', value: 0.38 },
                { name: 'Chestnut Hill', zip: '19118', value: 0.07 }
            ],
            overdose: [
                { name: 'Kensington', zip: '19134', value: 5.59 },
                { name: 'Nicetown-Tioga', zip: '19140', value: 4.82 },
                { name: 'Strawberry Mansion', zip: '19132', value: 4.15 },
                { name: 'Frankford', zip: '19124', value: 3.78 },
                { name: 'Southwest Philly', zip: '19143', value: 3.45 },
                { name: 'Cobbs Creek', zip: '19139', value: 3.12 },
                { name: 'North Philadelphia', zip: '19121', value: 2.89 },
                { name: 'Olney', zip: '19120', value: 2.45 },
                { name: 'Germantown', zip: '19144', value: 2.12 },
                { name: 'Chestnut Hill', zip: '19118', value: 0.42 }
            ],
            homicide: [
                { name: 'Strawberry Mansion', zip: '19132', value: 2.85 },
                { name: 'Nicetown-Tioga', zip: '19140', value: 2.54 },
                { name: 'Kensington', zip: '19134', value: 2.10 },
                { name: 'Southwest Philly', zip: '19143', value: 1.92 },
                { name: 'Frankford', zip: '19124', value: 1.78 },
                { name: 'North Philadelphia', zip: '19121', value: 1.65 },
                { name: 'Cobbs Creek', zip: '19139', value: 1.48 },
                { name: 'Olney', zip: '19120', value: 1.12 },
                { name: 'Germantown', zip: '19144', value: 0.95 },
                { name: 'Chestnut Hill', zip: '19118', value: 0.08 }
            ],
            incarceration: [
                { name: 'Strawberry Mansion', zip: '19132', value: 11.68 },
                { name: 'North Philly-East', zip: '19133', value: 11.97 },
                { name: 'Nicetown-Tioga', zip: '19140', value: 9.43 },
                { name: 'Cobbs Creek', zip: '19139', value: 7.91 },
                { name: 'North Philadelphia', zip: '19121', value: 7.43 },
                { name: 'Southwest Philly', zip: '19143', value: 7.23 },
                { name: 'Kensington', zip: '19134', value: 7.12 },
                { name: 'Frankford', zip: '19124', value: 5.88 },
                { name: 'Germantown', zip: '19144', value: 5.79 },
                { name: 'Chestnut Hill', zip: '19118', value: 0.52 }
            ],
            foster: [
                { name: 'Kensington', zip: '19134', value: 5.66 },
                { name: 'Nicetown-Tioga', zip: '19140', value: 4.92 },
                { name: 'Strawberry Mansion', zip: '19132', value: 4.45 },
                { name: 'Frankford', zip: '19124', value: 4.12 },
                { name: 'Southwest Philly', zip: '19143', value: 3.72 },
                { name: 'Cobbs Creek', zip: '19139', value: 3.35 },
                { name: 'North Philadelphia', zip: '19121', value: 3.08 },
                { name: 'Olney', zip: '19120', value: 2.65 },
                { name: 'Germantown', zip: '19144', value: 2.22 },
                { name: 'Chestnut Hill', zip: '19118', value: 0.38 }
            ],
            shooting: [
                { name: 'Nicetown-Tioga', zip: '19140', value: 1.85 },
                { name: 'Strawberry Mansion', zip: '19132', value: 1.72 },
                { name: 'Kensington', zip: '19134', value: 1.58 },
                { name: 'Southwest Philly', zip: '19143', value: 1.42 },
                { name: 'Frankford', zip: '19124', value: 1.28 },
                { name: 'North Philadelphia', zip: '19121', value: 1.15 },
                { name: 'Cobbs Creek', zip: '19139', value: 0.98 },
                { name: 'Olney', zip: '19120', value: 0.75 },
                { name: 'Germantown', zip: '19144', value: 0.58 },
                { name: 'Chestnut Hill', zip: '19118', value: 0.05 }
            ]
        };
        
        const units = { loss: 'Index', overdose: 'per 1,000', homicide: 'per 1,000', incarceration: 'per 1,000', foster: 'per 1,000', shooting: 'per 1,000' };
        
        function getBarClass(value, max) {
            const ratio = value / max;
            if (ratio > 0.75) return 'bar-high';
            if (ratio > 0.5) return 'bar-medium-high';
            if (ratio > 0.25) return 'bar-medium';
            return 'bar-low';
        }
        
        function renderBarChart(indicator) {
            const data = zipData[indicator];
            const max = Math.max(...data.map(d => d.value));
            const container = document.getElementById('barChart');
            
            container.innerHTML = data.map(item => {
                const width = (item.value / max) * 100;
                const barClass = getBarClass(item.value, max);
                return `<div class="bar-row"><div class="bar-label">${item.name}<div class="zip">ZIP ${item.zip}</div></div><div class="bar-wrapper"><div class="bar-fill ${barClass}" style="width: ${width}%">${width > 25 ? `<span class="bar-value">${item.value.toFixed(2)}</span>` : ''}</div></div>${width <= 25 ? `<span class="bar-value-outside">${item.value.toFixed(2)}</span>` : '<span class="bar-value-outside"></span>'}</div>`;
            }).join('');
        }
        
        document.querySelectorAll('.indicator-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.indicator-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderBarChart(btn.dataset.indicator);
            });
        });
        
        renderBarChart('loss');
    </script>
</body>
</html>
